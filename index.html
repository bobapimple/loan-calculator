<!DOCTYPE html>
<html lang="kk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>“ö–∞—Ä–∂—ã –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã</title>
  <link rel="stylesheet" href="style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <script src="https://cdn.sheetjs.com/xlsx-0.20.0/package/dist/xlsx.full.min.js"></script>

  <style>
    .tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 1rem;
      gap: 10px;
    }
    .tab-btn {
      padding: 10px 20px;
      border: none;
      background: #ccc;
      border-radius: 10px;
      cursor: pointer;
      font-weight: bold;
    }
    .tab-btn.active {
      background: #4caf50;
      color: white;
    }
    .card {
      max-width: 500px;
      margin: 0 auto;
    }
  </style>
</head>
<body>

  <!-- Theme Toggle -->
  <button id="themeToggle" class="theme-toggle">
    <i class="fas fa-moon"></i>
  </button>

  <div class="container fade-in">
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('loan')"><i class="fas fa-money-check-alt"></i> –ö—Ä–µ–¥–∏—Ç</button>
      <button class="tab-btn" onclick="switchTab('deposit')"><i class="fas fa-piggy-bank"></i> –î–µ–ø–æ–∑–∏—Ç</button>
    </div>

    <!-- –ö—Ä–µ–¥–∏—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã -->
    <div id="loan" class="card slide-up">
      <h2><i class="fas fa-calculator"></i> –ù–µ—Å–∏–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã</h2>
      <label>–ù–µ—Å–∏–µ —Å–æ–º–∞—Å—ã (‚Ç∏)</label>
      <input type="number" id="loanAmount" value="1000000" />

      <label>–ñ—ã–ª–¥—ã“õ –ø–∞–π—ã–∑ (%)</label>
      <input type="number" id="loanRate" value="20" />

      <label>–ú–µ—Ä–∑—ñ–º (–∞–π)</label>
      <input type="number" id="loanMonths" value="12" />

      <label>–ê–π–ª—ã“õ —Ç–∞–±—ã—Å (‚Ç∏)</label>
      <input type="number" id="income" value="500000" />

      <label>–ê–π–ª—ã“õ —à—ã“ì—ã–Ω (‚Ç∏)</label>
      <input type="number" id="expenses" value="200000" />

      <button onclick="calculateLoan()">–ï—Å–µ–ø—Ç–µ—É</button>

      <!-- HTML: –≤–Ω—É—Ç—Ä–∏ <div id="loanResult" ...> -->
<div id="loanResult" class="result-card bounce-in" style="display: none;">
  <h3>–ù”ô—Ç–∏–∂–µ:</h3>
  <div id="loanSummary"></div>

  <!-- –ö–æ–Ω—Ç—Ä–æ–ª—ã -->
  <div id="loanControls" style="margin: 15px 0; display: flex; gap: 10px;">
    <button id="exportBtn">üíæ –°–∫–∞—á–∞—Ç—å Excel</button>
    <button id="printBtn">üñ® –ü–µ—á–∞—Ç—å –≥—Ä–∞—Ñ–∏–∫–∞</button>
    <button id="toggleBtn">üîΩ –°–∫—Ä—ã—Ç—å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</button>
  </div>

  <!-- –¢–∞–±–ª–∏—Ü–∞ -->
  <h4>üìÖ –¢”©–ª–µ–º –∫–µ—Å—Ç–µ—Å—ñ:</h4>
  <table id="paymentSchedule" style="width:100%; border-collapse: collapse; margin-top:10px;">
    <thead>
      <tr>
        <th style="border-bottom:1px solid #999; padding:4px;">–ê–π</th>
        <th style="border-bottom:1px solid #999; padding:4px;">–ö“Ø–Ω—ñ</th>
        <th style="border-bottom:1px solid #999; padding:4px;">–¢”©–ª–µ–º</th>
        <th style="border-bottom:1px solid #999; padding:4px;">–ü–∞–π—ã–∑</th>
        <th style="border-bottom:1px solid #999; padding:4px;">–ù–µ–≥—ñ–∑–≥—ñ “õ–∞—Ä—ã–∑</th>
        <th style="border-bottom:1px solid #999; padding:4px;">“ö–∞–ª“ì–∞–Ω “õ–∞—Ä—ã–∑</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

    </div>

    <!-- –î–µ–ø–æ–∑–∏—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã -->
    <div id="deposit" class="card slide-up" style="display: none;">
      <h2><i class="fas fa-calculator"></i> –î–µ–ø–æ–∑–∏—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä—ã</h2>
      <label>–°–∞–ª—ã–º —Å–æ–º–∞—Å—ã (‚Ç∏)</label>
      <input type="number" id="depositAmount" value="1000000" />

      <label>–ñ—ã–ª–¥—ã“õ –ø–∞–π—ã–∑ (%)</label>
      <input type="number" id="depositRate" value="10" />

      <label>–ú–µ—Ä–∑—ñ–º (–∞–π)</label>
      <input type="number" id="depositMonths" value="12" />

      <label>–ê–π —Å–∞–π—ã–Ω“ì—ã “õ–æ—Å—ã–º—à–∞ —Å–∞–ª—ã–º (‚Ç∏)</label>
      <input type="number" id="monthlyAddition" value="0" />

      <button onclick="calculateDeposit()">–ï—Å–µ–ø—Ç–µ—É</button>

      <div id="depositResult" class="result-card bounce-in" style="display: none;"></div>
    </div>
  </div>

  <script>
    function switchTab(tab) {
      document.getElementById('loan').style.display = tab === 'loan' ? 'block' : 'none';
      document.getElementById('deposit').style.display = tab === 'deposit' ? 'block' : 'none';

      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelector(`.tab-btn[onclick="switchTab('${tab}')"]`).classList.add('active');
    }

    function calculateLoan() {
      const P = parseFloat(document.getElementById('loanAmount').value);
      const i = parseFloat(document.getElementById('loanRate').value) / 100 / 12;
      const n = parseInt(document.getElementById('loanMonths').value);
      const income = parseFloat(document.getElementById('income').value);
      const expenses = parseFloat(document.getElementById('expenses').value);

      const A = P * (i * Math.pow(1 + i, n)) / (Math.pow(1 + i, n) - 1);
      const totalPaid = A * n;
      const overpaid = totalPaid - P;

      let advice = "";
      if (A > income / 2) {
        advice += "üí° –ê–π —Å–∞–π—ã–Ω“ì—ã —Ç”©–ª–µ–º —Ç–∞–±—ã—Å—ã“£—ã–∑–¥—ã“£ –∂–∞—Ä—Ç—ã—Å—ã–Ω–∞–Ω –∫”©–ø. “ö—ã—Å“õ–∞ –º–µ—Ä–∑—ñ–º–Ω–µ–Ω –∞—É–ª–∞“õ –±–æ–ª—ã“£—ã–∑. ";
      }
      if ((overpaid / P) > 0.3) {
        advice += "üìâ –ü–∞–π—ã–∑–¥—ã“õ –∞—Ä—Ç—ã“õ —Ç”©–ª–µ–º –∂–æ“ì–∞—Ä—ã. –ë–∞—Å“õ–∞ “±—Å—ã–Ω—ã—Å—Ç–∞—Ä–¥—ã “õ–∞—Ä–∞—Å—Ç—ã—Ä“ì–∞–Ω –∂”©–Ω.";
      }
      if (advice === "") {
        advice = "‚úÖ –ù–µ—Å–∏–µ–ª—ñ–∫ —à–∞—Ä—Ç—Ç–∞—Ä —Å—ñ–∑–¥—ñ“£ —Ç–∞–±—ã—Å—ã“£—ã–∑“ì–∞ —Å”ô–π–∫–µ—Å –∫–µ–ª–µ–¥—ñ.";
      }

      document.getElementById('loanResult').style.display = 'block';
      document.getElementById('loanResult').innerHTML = `
        <h3>–ù”ô—Ç–∏–∂–µ:</h3>
        <p>üìÜ –ê–π —Å–∞–π—ã–Ω“ì—ã —Ç”©–ª–µ–º: <strong>${A.toFixed(2)} ‚Ç∏</strong></p>
        <p>üíµ –ñ–∞–ª–ø—ã —Ç”©–ª–µ–Ω–µ—Ç—ñ–Ω —Å–æ–º–∞: <strong>${totalPaid.toFixed(2)} ‚Ç∏</strong></p>
        <p>üìà –ê—Ä—Ç—ã“õ —Ç”©–ª–µ–º: <strong>${overpaid.toFixed(2)} ‚Ç∏</strong></p>
        <div class="advice">üß† –ö–µ“£–µ—Å: ${advice}</div>
      `;
    }

    function calculateDeposit() {
      const P = parseFloat(document.getElementById('depositAmount').value);
      const annualRate = parseFloat(document.getElementById('depositRate').value);
      const n = parseInt(document.getElementById('depositMonths').value);
      const monthlyAdd = parseFloat(document.getElementById('monthlyAddition').value);

      const i = annualRate / 100 / 12;
      let futureValue = P * Math.pow(1 + i, n);

      for (let t = 1; t <= n; t++) {
        futureValue += monthlyAdd * Math.pow(1 + i, n - t);
      }

      const totalInvested = P + (monthlyAdd * n);
      const profit = futureValue - totalInvested;

      let advice = profit / totalInvested > 0.1
        ? "‚úÖ –°–∞–ª—ã–º –∂–∞“õ—Å—ã —Ç–∞–±—ã—Å ”ô–∫–µ–ª–µ–¥—ñ."
        : "üí° –¢–∞–∑–∞ —Ç–∞–±—ã—Å —Ç”©–º–µ–Ω. –ñ–æ“ì–∞—Ä—ã –ø–∞–π—ã–∑–¥—ã –¥–µ–ø–æ–∑–∏—Ç—Ç–µ—Ä–¥—ñ “õ–∞—Ä–∞—Å—Ç—ã—Ä—É“ì–∞ –±–æ–ª–∞–¥—ã.";

      document.getElementById('depositResult').style.display = 'block';
      document.getElementById('depositResult').innerHTML = `
        <h3>–ù”ô—Ç–∏–∂–µ:</h3>
        <p>üìä –ë–æ–ª–∞—à–∞“õ —Å–æ–º–∞: <strong>${futureValue.toFixed(2)} ‚Ç∏</strong></p>
        <p>üí∞ –¢–∞–∑–∞ —Ç–∞–±—ã—Å: <strong>${profit.toFixed(2)} ‚Ç∏</strong></p>
        <div class="advice">üß† –ö–µ“£–µ—Å: ${advice}</div>
      `;
    }

    // Theme toggle logic
    const toggle = document.getElementById('themeToggle');
    const root = document.documentElement;

    function setTheme(theme) {
      root.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      toggle.innerHTML = theme === 'dark'
        ? '<i class="fas fa-sun"></i>'
        : '<i class="fas fa-moon"></i>';
    }

    toggle.addEventListener('click', () => {
      const current = root.getAttribute('data-theme');
      setTheme(current === 'dark' ? 'light' : 'dark');
    });

    setTheme(localStorage.getItem('theme') || 'light');
  </script>
  <script src="script.js"></script>

</body>
</html>
